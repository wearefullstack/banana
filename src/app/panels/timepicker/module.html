<div ng-controller='timepicker' ng-init="init()">
  <style>
    .timepicker-timestring {
      font-weight: normal;
    }

    .timepicker-dropdown {
      margin: 0px !important;
      border: 0px !important;
    }
  </style>
<<<<<<< HEAD
  <div class="row-fluid form-horizontal" ng-switch="panel.mode" ng-show="filterSrv.idsByType('time').length > 0">
    <div ng-switch-when="absolute" >
      <div class="timepicker-block">
        <form class="nomargin">
          <input type="text" class="input-smaller" ng-change="time_check()" ng-model="timepicker.from.date" data-date-format="mm/dd/yyyy" bs-datepicker>
          <input type="text" class="input-mini" ng-change="time_check()" data-show-meridian="false" data-show-seconds="true" ng-model="timepicker.from.time" bs-timepicker>
        </form>
      </div>
      to
      <div class="timepicker-block" style="margin-left:5px">
        <form class="nomargin">
          <input type="text" class="input-smaller" ng-change="time_check()" ng-model="timepicker.to.date" data-date-format="mm/dd/yyyy" bs-datepicker>
          <input type="text" class="input-mini" ng-change="time_check()" data-show-meridian="false" data-show-seconds="true" ng-model="timepicker.to.time" bs-timepicker> <!--(<a ng-click="to_now()">now</a>)-->
      </form>
      </div>
      <div class="timepicker-block">
        <form class="nomargin">
          <button class="btn" ng-click="time_apply()"><i class="icon-ok"></i></button>
        </form>
      </div>
    </div>
    <div ng-switch-when="since">
      <div class="timepicker-block">
        <form class="nomargin">
          <input type="text" class="input-smaller" ng-change="time_check()" ng-model="timepicker.from.date" data-date-format="mm/dd/yyyy" bs-datepicker>
          <input type="text" class="input-mini" ng-change="time_check()" data-show-meridian="false" data-show-seconds="true" ng-model="timepicker.from.time" bs-timepicker>
        </form>
      </div>
      <div class="timepicker-block" style="margin-left:5px">
        <form class="nomargin">
          <button class="btn" ng-click="time_apply()"><i class="icon-ok"></i></button>
        </form>
      </div>
    </div>
    <div ng-switch-when="relative">
      <div class="timepicker-block">
        <form class="nomargin input-append">
          <button class="btn btn" ng-repeat='timespan in panel.time_options' ng-class="{'btn-success': (panel.timespan == timespan)}" ng-click="set_timespan(timespan)">{{timespan}}</button>
          <!--<select ng-model="panel.sort[0]" ng-options="f for f in fields"></select>-->
        </form>
      </div>
    </div>
  </div>
  <div class="row-fluid" ng-show="filterSrv.idsByType('time').length < 1">
    <div>
      <div class="span11">
        <h4>No time filter present</h4>
      </div>
    </div>
  </div>
  <div class="row-fluid nomargin">
    <div class="span12 small" ng-show="filterSrv.idsByType('time').length > 0">
      <a class="link" ng-click="set_mode('relative')" ng-class="{'strong': (panel.mode == 'relative')}">Relative</a> |
      <a class="link" ng-click="set_mode('absolute')" ng-class="{'strong': (panel.mode == 'absolute')}">Absolute</a> |
      <a class="link" ng-click="set_mode('since')"    ng-class="{'strong': (panel.mode == 'since')}">Since</a>
      <span ng-hide="panel.mode == 'absolute' || panel.mode == 'none'"> |
        <input type="checkbox" ng-model="panel.refresh.enable" ng-change='refresh();'> Auto-refresh
        <span ng-class="{'ng-cloak': !panel.refresh.enable}">
          every <a data-title="<small>Auto-refresh Settings</small>" data-placement="bottom" bs-popover="'app/panels/timepicker/refreshctrl.html'">{{panel.refresh.interval}}s</a>.
        </span>
      </span>
    </div>
    <div class="span12 small" ng-show="filterSrv.idsByType('time').length < 1">
      <a class='btn btn-small' ng-click="time_apply()">Create a time filter</a>
    </div>
  </div>
</div>
=======
  <!--  This is a complete hack. The form actually exists in the modal, but due to transclusion
        $scope.input isn't available on the controller unless the form element is in this file -->
  <form name="input" style="margin:3px 0 0 0">
    <ul class="nav nav-pills timepicker-dropdown">
      <li class="dropdown" bs-tooltip="(time.from.date | date:'yyyy-MM-dd HH:mm:ss.sss') + ' to ' +(time.to.date | date:'yyyy-MM-dd HH:mm:ss.sss')" data-placement="bottom" ng-click="dismiss();">

        <a class="dropdown-toggle timepicker-dropdown" data-toggle="dropdown" href="#">

          <span ng-show="filterSrv.idsByType('time').length">
            <span class="pointer" ng-hide="panel.now">{{time.from.date | date:'MMM d, y HH:mm:ss'}}</span>
            <span class="pointer" ng-show="panel.now">{{time.from.date | moment:'ago'}}</span>
            to
            <span class="pointer" ng-hide="panel.now" >{{time.to.date | date:'MMM d, y HH:mm:ss'}}</span>
            <span class="pointer" ng-show="panel.now">{{time.to.date | moment:'ago'}}</span>
          </span>
          <span ng-hide="filterSrv.idsByType('time').length">Set a time filter</span>
          <span ng-show="dashboard.current.refresh" class="text-warning">refreshed every {{dashboard.current.refresh}} </span>
          <i class="icon-caret-down"></i>
        </a>

        <ul class="dropdown-menu">
          <!-- Relative time options -->
          <li ng-repeat='timespan in panel.time_options track by $index'>
            <a ng-click="setRelativeFilter(timespan)">Last {{timespan}}</a>
          </li>

          <!-- Auto refresh submenu -->
          <li class="dropdown-submenu">
            <a href="#">Auto-Refresh</a>
            <ul class="dropdown-menu">
              <li><a ng-click="dashboard.set_interval(false)">Off</a></li>
              <li ng-repeat="interval in panel.refresh_intervals track by $index"><a ng-click="dashboard.set_interval(interval)">Every {{interval}}</a></li>
            </ul>
          </li>
          <li><a ng-click="customTime()">Custom</a></li>
        </ul>

      </li>
    </ul>

  </form>
</div>
>>>>>>> origin/master
